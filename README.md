# ğŸŠ Kayman CRM

CRM Ğ´Ğ»Ñ ÑˆĞºĞ¾Ğ»Ñ‹ Ğ¿Ğ»Ğ°Ğ²Ğ°Ğ½Ğ¸Ñ. Next.js + Supabase.

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser   â”‚â—„â”€â”€â”€â–ºâ”‚  Next.js    â”‚â—„â”€â”€â”€â–ºâ”‚  Supabase    â”‚
â”‚  (React)   â”‚     â”‚  App Router â”‚     â”‚  (Postgres)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  + Auth      â”‚
                                       â”‚  + RLS       â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Next.js App Router** â€” SSR + ĞºĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
- **Supabase Auth** â€” email/password login
- **Supabase Postgres + RLS** â€” Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ + Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ‘Ğ”
- **Tailwind CSS** â€” ÑÑ‚Ğ¸Ğ»Ğ¸

## Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ‘Ğ”

| Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ |
|---------|-----------|
| trainers | Ğ¢Ñ€ĞµĞ½ĞµÑ€Ñ‹ |
| profiles | Ğ¡Ğ²ÑĞ·ÑŒ user â†” Ñ€Ğ¾Ğ»ÑŒ (admin/trainer) |
| clients | ĞšĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹ (Ğ´ĞµÑ‚Ğ¸ + Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ğ¸) |
| bookings | Ğ—Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ½Ğ° Ğ·Ğ°Ğ½ÑÑ‚Ğ¸Ñ |
| templates | Ğ Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ñ‹ Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ¾Ğ² |
| template_assignments | Ğ—Ğ°ĞºÑ€ĞµĞ¿Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ² ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğµ |
| tasks | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ |

## RLS (Row Level Security)

- **admin** â€” Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ ĞºĞ¾ Ğ²ÑĞµĞ¼Ñƒ
- **trainer** â€” Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ bookings, ÑĞ²Ğ¾Ğ¸Ñ… clients, ÑĞ²Ğ¾Ğ¸ tasks
- ĞœÑĞ³ĞºĞ¸Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· `archived_at`

---

## ĞšĞ°Ğº Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ â€” Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾

### 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Supabase

1. Ğ—Ğ°Ğ¹Ğ´Ğ¸ Ğ½Ğ° [supabase.com](https://supabase.com) â†’ **New Project**
2. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½, Ğ·Ğ°Ğ´Ğ°Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ Ğ‘Ğ”
3. Ğ”Ğ¾Ğ¶Ğ´Ğ¸ÑÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ (~2 Ğ¼Ğ¸Ğ½)
4. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹ Ğ¸Ğ· **Settings â†’ API**:
   - `Project URL` â†’ ÑÑ‚Ğ¾ `NEXT_PUBLIC_SUPABASE_URL`
   - `anon public` key â†’ ÑÑ‚Ğ¾ `NEXT_PUBLIC_SUPABASE_ANON_KEY`

### 2. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸ SQL Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ

1. Ğ’ Supabase Dashboard Ğ¾Ñ‚ĞºÑ€Ğ¾Ğ¹ **SQL Editor**
2. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ `supabase/migrations/001_init.sql`
3. ĞĞ°Ğ¶Ğ¼Ğ¸ **Run** â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ´ÑƒÑ‚ÑÑ Ğ²ÑĞµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹, Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ Ğ¸ RLS Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸

### 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (admin)

1. Ğ’ Supabase Dashboard â†’ **Authentication â†’ Users â†’ Add User**
2. Ğ’Ğ²ĞµĞ´Ğ¸ email Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
3. Ğ—Ğ°Ğ¿Ğ¾Ğ¼Ğ½Ğ¸ `User UID` (Ğ¾Ğ½ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑÑ Ğ² ÑĞ¿Ğ¸ÑĞºĞµ)
4. ĞÑ‚ĞºÑ€Ğ¾Ğ¹ **SQL Editor** Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸:

```sql
-- Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸ YOUR_USER_ID Ğ½Ğ° Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ UUID Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
INSERT INTO profiles (user_id, role)
VALUES ('YOUR_USER_ID', 'admin');
```

### 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾

```bash
# ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€ÑƒĞ¹ / Ñ€Ğ°ÑĞ¿Ğ°ĞºÑƒĞ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
cd kayman-crm

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
npm install

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ .env.local
cp .env.local.example .env.local
```

ĞÑ‚ĞºÑ€Ğ¾Ğ¹ `.env.local` Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ÑŒ ĞºĞ»ÑÑ‡Ğ¸ Ğ¸Ğ· ÑˆĞ°Ğ³Ğ° 1:
```
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...
```

### 5. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸

```bash
npm run dev
```

ĞÑ‚ĞºÑ€Ğ¾Ğ¹ http://localhost:3000 â€” ÑƒĞ²Ğ¸Ğ´Ğ¸ÑˆÑŒ Ğ»Ğ¾Ğ³Ğ¸Ğ½. Ğ’Ğ¾Ğ¹Ğ´Ğ¸ Ñ email/Ğ¿Ğ°Ñ€Ğ¾Ğ»ĞµĞ¼ Ğ¸Ğ· ÑˆĞ°Ğ³Ğ° 3.

### 6. ĞŸĞµÑ€Ğ²Ñ‹Ğµ ÑˆĞ°Ğ³Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

1. **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸** â†’ Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒ Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ¾Ğ²
2. **ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚ĞµĞ»Ğ¸** â†’ Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒ Ğ¿ĞµÑ€Ğ²Ñ‹Ñ… ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
3. **Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹** â†’ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ñ‡Ğ°ÑÑ‹ Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ° + Ğ·Ğ°ĞºÑ€ĞµĞ¿Ğ¸ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
4. **Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹** â†’ Ğ½Ğ°Ğ¶Ğ¼Ğ¸ Â«Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½ĞµĞ´ĞµĞ»ÑÂ»
5. **Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ** â†’ ÑƒĞ²Ğ¸Ğ´Ğ¸ÑˆÑŒ ÑĞµÑ‚ĞºÑƒ Ñ Ğ·Ğ°Ğ¿Ğ¸ÑÑĞ¼Ğ¸

### 7. Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ° ĞºĞ°Ğº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

1. Supabase â†’ Authentication â†’ Add User (email Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ°)
2. SQL Editor:
```sql
INSERT INTO profiles (user_id, role, trainer_id)
VALUES ('TRAINER_USER_ID', 'trainer', 'TRAINER_TABLE_ID');
```
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ñ‚Ñ€ĞµĞ½ĞµÑ€ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ñ‘ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ.

### 8. Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Vercel (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

1. Ğ—Ğ°Ğ»ĞµĞ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ½Ğ° GitHub
2. Ğ—Ğ°Ğ¹Ğ´Ğ¸ Ğ½Ğ° [vercel.com](https://vercel.com) â†’ **Import Project**
3. Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ Environment Variables:
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
4. Deploy â€” Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾!

---

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
kayman-crm/
â”œâ”€â”€ middleware.ts              # Auth redirect
â”œâ”€â”€ supabase/migrations/
â”‚   â””â”€â”€ 001_init.sql          # Ğ’ÑĞµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ + RLS
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts     # Browser client
â”‚   â”‚   â”‚   â”œâ”€â”€ server.ts     # Server client
â”‚   â”‚   â”‚   â””â”€â”€ middleware.ts  # Session refresh
â”‚   â”‚   â”œâ”€â”€ types.ts          # TypeScript types
â”‚   â”‚   â””â”€â”€ utils.ts          # Date/time helpers
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Nav.tsx           # Sidebar + mobile nav
â”‚   â”‚   â””â”€â”€ ui/Modal.tsx      # Reusable modal
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ login/page.tsx    # Login
â”‚       â”œâ”€â”€ (dashboard)/
â”‚       â”‚   â”œâ”€â”€ layout.tsx    # Nav wrapper
â”‚       â”‚   â”œâ”€â”€ schedule/     # ĞĞµĞ´ĞµĞ»ÑŒĞ½Ğ°Ñ ÑĞµÑ‚ĞºĞ°
â”‚       â”‚   â”œâ”€â”€ clients/      # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº + ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ°
â”‚       â”‚   â”œâ”€â”€ tasks/        # Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸
â”‚       â”‚   â”œâ”€â”€ templates/    # Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ñ‚Ñ€ĞµĞ½ĞµÑ€Ğ¾Ğ²
â”‚       â”‚   â””â”€â”€ settings/     # CRUD Ñ‚Ñ€ĞµĞ½ĞµÑ€Ñ‹ + ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚
â”‚       â””â”€â”€ auth/callback/    # OAuth callback
```
